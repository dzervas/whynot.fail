<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Cause when you fail, somebody has to laugh at you"><title>The art of cracking software | WhyNot.Fail</title><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Raleway:wght@400;500;600;700&display=swap" rel="stylesheet"><!-- Favicon --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="WhyNot.Fail RSS" href="/rss.xml"><style>.tag-list[data-astro-cid-lga65v7i]{display:flex;flex-wrap:wrap;gap:.5rem;list-style:none;padding:0;margin:0}.tag[data-astro-cid-lga65v7i]{display:inline-block;padding:.25rem .625rem;font-size:.8125rem;font-weight:500;text-decoration:none;color:var(--color-accent);background:var(--color-accent-bg);border:1px solid var(--color-accent-border);border-radius:4px;transition:all .15s ease}.tag[data-astro-cid-lga65v7i]:hover{background:var(--color-accent);color:var(--color-bg);border-color:var(--color-accent)}.build-badge[data-astro-cid-mzimu5gx]{display:inline-flex;align-items:center;font-family:JetBrains Mono,monospace;font-size:.8125rem;letter-spacing:.02em}.badge-prefix[data-astro-cid-mzimu5gx]{color:var(--color-text-muted)}.badge-status[data-astro-cid-mzimu5gx]{font-weight:600}.badge-passing[data-astro-cid-mzimu5gx] .badge-status[data-astro-cid-mzimu5gx]{color:var(--color-success)}.badge-failing[data-astro-cid-mzimu5gx] .badge-status[data-astro-cid-mzimu5gx]{color:var(--color-danger)}.badge-unknown[data-astro-cid-mzimu5gx] .badge-status[data-astro-cid-mzimu5gx]{color:var(--color-warning)}
</style>
<link rel="stylesheet" href="/_astro/_slug_.BSLznIs-.css">
<link rel="stylesheet" href="/_astro/_slug_.ClLXJwUM.css"></head> <body id="top"> <div class="site-wrapper"> <header class="site-header" data-astro-cid-3ef6ksr2> <div class="header-inner" data-astro-cid-3ef6ksr2> <a href="/" class="logo" aria-label="WhyNot.Fail" data-astro-cid-3ef6ksr2> <pre class="ascii-logo" aria-hidden="true" data-astro-cid-3ef6ksr2>
 ‚ñà   ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà ‚ñà‚ñÑ ‚ñà ‚ñà‚ñÄ‚ñà ‚ñÄ‚ñà‚ñÄ
 ‚ñà‚ñÑ‚ñà‚ñÑ‚ñà ‚ñà‚ñÄ‚ñà ‚ñÄ‚ñà‚ñÄ ‚ñà ‚ñÄ‚ñà ‚ñà‚ñÑ‚ñà  ‚ñà
        ¬∑FAIL¬∑
      </pre> <span class="logo-tagline" data-astro-cid-3ef6ksr2>// cause_when_you_fail_somebody_has_to_laugh_at_you</span> </a> <div class="header-actions" data-astro-cid-3ef6ksr2> <nav class="nav-main" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-cid-3ef6ksr2> Home </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about/" class="nav-link" data-astro-cid-3ef6ksr2> About </a> </li><li data-astro-cid-3ef6ksr2> <a href="/tags/" class="nav-link" data-astro-cid-3ef6ksr2> Tags </a> </li> </ul> </nav> <div class="search-shell" data-search-trigger data-astro-cid-3ef6ksr2> <input type="search" class="search-trigger" placeholder="Search" aria-label="Open search" readonly data-astro-cid-3ef6ksr2> <span class="search-shortcut" data-astro-cid-3ef6ksr2>Ctrl+K</span> </div> </div> </div> <div class="header-separator" aria-hidden="true" data-astro-cid-3ef6ksr2></div> </header>  <main class="main-content">  <article class="post" data-astro-cid-gjtny2mx> <header class="post-header" data-astro-cid-gjtny2mx> <div class="post-header-top" data-astro-cid-gjtny2mx> <a href="/" class="back-link" data-astro-cid-gjtny2mx> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-arrow-left "><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg> <span data-astro-cid-gjtny2mx>Back to posts</span> </a>  </div> <div class="post-meta" data-astro-cid-gjtny2mx> <time datetime="2022-11-02T00:00:00.000Z" data-astro-cid-gjtny2mx>02 November 2022</time> <span class="meta-sep" data-astro-cid-gjtny2mx>/</span> <span class="post-author" data-astro-cid-gjtny2mx>dzervas</span>  <span class="meta-sep" data-astro-cid-gjtny2mx>/</span> <span class="build-badge badge-unknown" data-astro-cid-mzimu5gx> <span class="badge-prefix" data-astro-cid-mzimu5gx>build:</span> <span class="badge-status" data-astro-cid-mzimu5gx>[???]</span> </span>   </div> <h1 class="post-title" data-astro-cid-gjtny2mx>The art of cracking software</h1> <div class="post-tags" data-astro-cid-gjtny2mx> <ul class="tag-list" data-astro-cid-lga65v7i><li data-astro-cid-lga65v7i><a href="/tags/reversing/" class="tag" data-astro-cid-lga65v7i>reversing</a></li><li data-astro-cid-lga65v7i><a href="/tags/windows/" class="tag" data-astro-cid-lga65v7i>windows</a></li></ul> </div> </header> <div class="post-hero" data-astro-cid-gjtny2mx> <img src="/images/notion-d9a68029-3609-4620-a527-2297ece9cbc6-warez-szene-razor1911-ist-zurueckgekehrt.webp" alt="The art of cracking software" loading="lazy" data-astro-cid-gjtny2mx> </div> <div class="post-content" data-astro-cid-gjtny2mx>  <p>As the years have gone by, it seems that cracking software is more and more synonymous to ‚Äúmalware‚Äù. As this world no longer knows how to operate in a manner of doing something for the common good, selfless moves that would give access to people that can‚Äôt bear the stupid ‚Äúentry price‚Äù have been shadowed by moves that replace that ‚Äúentry price‚Äù with remote access instead of money. It pains me and makes me sad, but at least I can share some aspect of it, as I‚Äôd rather not go to jail.</p>
<p>For some reason I‚Äôm not completely sure, I‚Äôve picked up the hobby of cracking niche softwares‚Äô licensing mechanisms. Maybe it‚Äôs because that I know for a fact that they can be cracked - something that isn‚Äôt given for hacking cloud-based software.</p>
<p>This is a research post. I don‚Äôt use or share my cracks. I do it for fun. Please don‚Äôt hurt me.</p>
<h1 id="defining-the-target">Defining the target</h1>
<p>My targets are exclusively Windows programs, but I‚Äôm sure a lot of the described techniques apply to any OS.</p>
<p>Each time I start cracking a program, I‚Äôve got to set a clear target. Most times is ‚Äúpermanent license that gives me access to everything‚Äù but that requires to know the following:</p>
<ul>
<li>Is there a trial version? If yes:</li>
<li>Forget about any kind of cloud-based features (cloud save, cloud-based computing, etc.)</li>
<li>Is the license ‚Äújust a serial number‚Äù or a whole file (binary or not)?</li>
<li>Does the software provide means of offline license activation?</li>
<li>What language is the app written in?</li>
<li>Do we have any kind of debug symbols?</li>
<li>Any kind of obfuscation or anti-reversing?
The only blocker in the above questions is if we have no access to the premium binary. Maybe the URL to download it is tucked somewhere inside the trial binary. If not, too bad, find something else.</li>
</ul>
<p>I‚Äôd also stop as soon as I found that the app has anti-reversing or serious obfuscation. I‚Äôd really like to have fun and not spend the good part of a year for a single app. I‚Äôm not a good reverser anyway and I don‚Äôt want to be - these people are scary.</p>
<p>Another part of my cracking adventure is developing the ‚Äúperfect crack‚Äù. The one that tinkers the app the least and allows me to maintain it across versions. I don‚Äôt want just to patch a DLL. It‚Äôs dirty. We‚Äôll see better techniques further down.</p>
<h1 id="first-impressions">First impressions</h1>
<p>Play a bit around with the software see what it does. Identify useful strings (like <code>Trial</code> or <code>Expires</code>) inside the app so you‚Äôve got stuff to search.</p>
<p>How does it behave if you give it a wrong serial number? If you disable the internet? Where does it store license stuff? Maybe in the registry? Are there any interesting keys in there? If the license is stored in a file, poke it. Is it encrypted? Signed? Has a checksum?</p>
<p>At this point there are no wrong directions. Poke the program and start building confidence in the app. What it means to run correctly. You should crash the app at least once. Don‚Äôt be afraid, you can just re-install it.</p>
<h1 id="network-inspection">Network inspection</h1>
<p>Fire up Burp and pass the whole VM traffic through it (you‚Äôre using a VM right? RIIIIGHT???)</p>
<p>Identify the URLs and check for SSL pinning. Then install Burp‚Äôs root cert in the VM and check again.</p>
<p>If it‚Äôs SSL pinned bypassing it shouldn‚Äôt be that hard (we‚Äôll see some examples later)</p>
<p>Right now you‚Äôre looking for the following:</p>
<ul>
<li>Does the serial number get sent to the backend?</li>
<li>If yes, check the responses of correct and incorrect license numbers</li>
<li>If not, check for kinda weird-looking strings, encrypted strings and signatures. Maybe the license is used to generate another string to obfuscate it over the wire
There‚Äôs a pretty good chance that right now you‚Äôve found already a solid entrypoint. The app sends some computer based fingerprint with the license key to the licensing server and expects a structured response that describes the kind of license that we have.</li>
</ul>
<p>In my experience following this route has not been fruitful. In all of such encounters the request and response are signed and sometimes even encrypted. But the most problematic aspect is identifying the required structure that the app expects. Instead of <code>22-dec-2022</code> that the expiration date is set you try <code>22-dec-2032</code> - after bypassing the signature check of course. But for some reason it doesn‚Äôt work - data are encoded elsewhere as well? Maybe if you change <code>trial</code> to <code>premium</code>? Or to <code>ultimate</code>? Why are there both strings inside the app? Is that case sensitive?</p>
<p>These might seem like easy problems but, let me tell you, they‚Äôre definitely not. Compilers have gone mental with optimization and understanding a C++ object through reversing is it‚Äôs own mountain. How would you know that <code>ultimate</code> needs a <code>is_network_license</code> to false - while <code>trial</code> does not?</p>
<p>From all the programs that I‚Äôve cracked, I‚Äôve never found one that does a ‚Äúsimple enough‚Äù network call to check the license. They all use some kind of licensing solution that has signatures and encryptions n stuff that make network-based cracking as hard as ‚Äúregular‚Äù cracking (hooking/patching n stuff).</p>
<p>So now what?</p>
<h1 id="dynamic-instrumentation---native-apps">Dynamic Instrumentation - Native apps</h1>
<p>Let me introduce you to the amazing world of: üåà<a href="https://frida.re">frida</a>üåà</p>
<p>It‚Äôs a stupidly powerful dynamic instrumentation framework, mainly targeting mobile apps but it works great on all Desktop OSes as well. Think of it like Inspect Element for native apps.</p>
<p>It works by injecting a JavaScript Engine inside the target process. That essentially allows you to inject or even replace native function with JavaScript code. Here for example we hook the debugging output the target app runs:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F97583">let</span><span style="color:#E1E4E8"> OutputDebugStringW_export </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Module.</span><span style="color:#B392F0">getExportByName</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"kernel32.dll"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"OutputDebugStringW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">let</span><span style="color:#E1E4E8"> OutputDebugStringW_new </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> NativeCallback</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">str</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">		// Redefine the code executed - yeap, plain javascript.</span></span>
<span class="line"><span style="color:#6A737D">		// `str` is gonna be a pointer as we tell further down.</span></span>
<span class="line"><span style="color:#6A737D">		// As the return type is void, we don't have to return anything</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">		// Since this is a pointer, we can treat it in any way we like. Here we read it as Utf16 - part of the frida API</span></span>
<span class="line"><span style="color:#E1E4E8">		console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(str.</span><span style="color:#B392F0">readUtf16String</span><span style="color:#E1E4E8">());</span></span>
<span class="line"><span style="color:#E1E4E8">	},</span></span>
<span class="line"><span style="color:#9ECBFF">	"void"</span><span style="color:#E1E4E8">, </span><span style="color:#6A737D">// Return type</span></span>
<span class="line"><span style="color:#E1E4E8">	[ </span><span style="color:#9ECBFF">"pointer"</span><span style="color:#E1E4E8"> ] </span><span style="color:#6A737D">// Argument list. They will be passed to the above function as regular arguments</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span></code></pre>
<p>The above can then be run as follows:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E1E4E8">frida.exe </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">f MyAwesomeApp.exe </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">l HookDebugStringW.js</span></span></code></pre>
<p>This will spawn the app but you can also hook onto an already running process with <code>-n</code> flag instead of <code>-f</code>. After that you‚Äôre thrown into an interactive JS shell that you can enter commands or change the script that is automatically re-applied once it changes on disk. I can‚Äôt possibly overstate how powerful this tool is. And it doesn‚Äôt stop there!</p>
<p>The exact reason of why would you hook a debug output is not the point. That could be an exported symbol of the program or even one of its DLLs. But what if you just wanna search for a bunch of function names and wanna see if they get called in the specific flow that you‚Äôre researching? Enter <code>frida-trace</code>.</p>
<p>Instead of writing hooks like the above over and over, that tool does most of the job for you and can also pattern match function names. Almost my first command when I start the reversing phase is the following:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E1E4E8">frida</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">trace.exe </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">n MyAwesomeApp.exe </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">i </span><span style="color:#9ECBFF">'MyAwesomeApp.exe!*License*'</span></span></code></pre>
<p>I run that right before I click some kind of license checking button after I‚Äôve entered the license string and I check to see if any function with a name that matches the pattern <code>*License*</code> (note: case sensitive) inside the module <code>MyAwesomeApp.exe</code> (note: case sensitive as well - many times the module name is in a different case than the file. Use <code>Process.enumerateModulesSync()</code> inside the frida shell) fires up. I‚Äôm limiting the search in that module to avoid hooking thousands of functions - which is a very good recipe for an instant crash. You can either make the pattern a bit more targeted and remove the module part or change the module to a spicy named DLL. You can also hook all the functions of a module with <code>-I liblicense_of_MyAwesomeApp.dll</code> but again, if the exports are too many it‚Äôll crash.</p>
<p>At this point, for the not-so-experienced crackers, I should note that the whole time I‚Äôm talking about functions that have exported symbols. If the app has stripped the names of the functions and the function that you‚Äôre aiming for is called from inside the module, the aforementioned technique will bear no fruits as there won‚Äôt be any functions found to hook. The windows-native functions though (<code>user32.dll</code> or <code>kernel32.dll</code> for example) will always work as those DLLs have well known exports. It‚Äôs a very accurate way of finding out the environment variables that the app accepts, WMI queries that it does, registry keys that it uses and maybe even some crypto stuff that it uses to check the license.</p>
<h1 id="reversing---native-apps">Reversing - Native apps</h1>
<p>I don‚Äôt know what you‚Äôre expecting here but I‚Äôm not a good reverser. At all. Fire up ghidra and start looking for strings and go back from there. I‚Äôve got one piece of a one-liner though to find spicy DLLs fast:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">fd</span><span style="color:#9ECBFF"> .</span><span style="color:#9ECBFF"> ~/.wine/drive_c/Program</span><span style="color:#79B8FF">\ </span><span style="color:#9ECBFF">Files/MyAwesomeApp</span><span style="color:#79B8FF"> -H</span><span style="color:#79B8FF"> -t</span><span style="color:#9ECBFF"> f</span><span style="color:#79B8FF"> -x</span><span style="color:#9ECBFF"> sh</span><span style="color:#79B8FF"> -c</span><span style="color:#9ECBFF"> 'strings -a -e l "{}" | rg -i "license" &#x26;&#x26; echo -e "\t>{}"'</span></span></code></pre>
<p>What this does is run <code>strings</code>to all the files recursively under <code>~/.wine/...</code> but with a twist: the <code>-e l</code> flag. This makes all the difference. You see Windows like 16 bit little endian characters. But not always. Maybe big endian (<code>-e b</code>) or maybe regular ASCII (no <code>-e</code> flag at all). This note took me a week to find out. Cheers.</p>
<p>While it‚Äôs very tempting, don‚Äôt invest much time finding ‚Äúa single function that if returns true everything is super-premium-ultimate-version‚Äù. Nowadays everyone loves object orientation and most often than not a ‚Äúsubtle‚Äù change could require huge changes in the object that represents the license. I have however stumbled upon such a marvelously written software!</p>
<p>It‚Äôs one of the most widely used software in its market and: IT‚ÄôS CLOUD BASED. Yeap. It‚Äôs mostly an electron app that loads remote content and I just didn‚Äôt even try to crack it for months. ‚ÄúIt should load the code that is required for my specific license‚Äù I thought. NOP! It had an <code>isUltimate</code> function that when hooked to return <code>true</code>, I was magically Ultimate.</p>
<p>Most of the other software though weren‚Äôt that nice. Even apps that share just a tiny fraction of the market used some kind of licensing solution that as said before has some difficulty - Stripped symbols, encryption, signing, public/private keys and even sometimes statically compiled crypto functions.</p>
<h2 id="a-word-on-keygens">A word on keygens</h2>
<p>I think that key generators are the epitome of art in terms of cracking. It‚Äôs so slick and not intruding and sometimes quite hard to counter-measure from the perspective of the developer so many times it‚Äôs resilient to updates. But it‚Äôs hard. Very hard.</p>
<p>I‚Äôve stumbled upon a C# app that I cracked using a keygen. I found a ‚Äúmagic license key‚Äù to put it in offline mode so that it accepts license keys that are checked using some math. But it used some archaic Windows hashing function that was a pain to re-implement and required some very weird math. It was also hidden in plain site - The function <code>CheckLicense</code> was never called (and it also had some even more weird math that took me 3 days to understand that make no actual sense) and the actual function was named something like <code>CalculateOrbitalTrajectory</code>. The only way that I could find that was through dynamic instrumentation.</p>
<p>On another app I cracked the public DSA-512 public key that it used to verify the license signature. I had already cracked it through hooking but I wanted to completely own it so I cracked the key - I never got to use it tho as it needed some weird transformations and I got bored. Again, the structuring of data is a huge roadblock. Here‚Äôs though how I cracked a DSA-512 public key in 2 days (there are MUCH better and faster ways to do it but that‚Äôs the only way it worked for me - also I‚Äôm bad at cryptanalysis):</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># All the key data have been changed</span></span>
<span class="line"><span style="color:#6A737D"># Extract the PEM public key from inside the binary</span></span>
<span class="line"><span style="color:#B392F0">openssl</span><span style="color:#9ECBFF"> dsa</span><span style="color:#79B8FF"> -pubin</span><span style="color:#79B8FF"> -in</span><span style="color:#9ECBFF"> anotherAwesomeApp_public_key.pem</span><span style="color:#79B8FF"> -noout</span><span style="color:#79B8FF"> -modulus</span></span>
<span class="line"><span style="color:#79B8FF">read</span><span style="color:#9ECBFF"> DSA</span><span style="color:#9ECBFF"> key</span></span>
<span class="line"><span style="color:#B392F0">Public</span><span style="color:#9ECBFF"> Key=2A0ABA86F22281B123F33D9E073AC921C0F2BCB0114C07F632129B64C3CA4181D84C998C2556DC69CB30E0D6B7CB761274AAFC6834FE74D6721E6EA6BCD68DEA</span></span>
<span class="line"><span style="color:#6A737D"># Hex to decimal</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> echo</span><span style="color:#9ECBFF"> "ibase=16;2A0ABA86F22281B123F33D9E073AC921C0F2BCB0114C07F632129B64C3CA4181D84C998C2556DC69CB30E0D6B7CB761274AAFC6834FE74D6721E6EA6BCD68DEA"</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> bc</span></span>
<span class="line"><span style="color:#B392F0">22019134240820916317814169763607118015464182266127018258054642617293\</span></span>
<span class="line"><span style="color:#E1E4E8">88614872096293260765941335270405591230469600688971077042627869124706</span><span style="color:#79B8FF">\</span></span>
<span class="line"><span style="color:#E1E4E8">949973008545385962</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># And then run [cado-nfs](http://cado-nfs.gforge.inria.fr/) through docker to</span></span>
<span class="line"><span style="color:#6A737D"># factor the number (steps from [here](https://www.doyler.net/security-not-included/cracking-256-bit-rsa-keys)):</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> docker</span><span style="color:#9ECBFF"> run</span><span style="color:#79B8FF"> -d</span><span style="color:#79B8FF"> --name</span><span style="color:#9ECBFF"> anotherAwesomeApp_public</span><span style="color:#9ECBFF"> cyrilbouvier/cado-nfs.py</span><span style="color:#79B8FF"> 2201913424082091631781416976360711801546418226612701825805464261729388614872096293260765941335270405591230469600688971077042627869124706949973008545385962</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> docker</span><span style="color:#9ECBFF"> logs</span><span style="color:#79B8FF"> -f</span><span style="color:#9ECBFF"> anotherAwesomeApp_public</span></span>
<span class="line"><span style="color:#B392F0">Unable</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> find</span><span style="color:#9ECBFF"> image</span><span style="color:#9ECBFF"> 'cyrilbouvier/cado-nfs.py:latest'</span><span style="color:#9ECBFF"> locally</span></span>
<span class="line"><span style="color:#B392F0">latest:</span><span style="color:#9ECBFF"> Pulling</span><span style="color:#9ECBFF"> from</span><span style="color:#9ECBFF"> cyrilbouvier/cado-nfs.py</span></span>
<span class="line"><span style="color:#B392F0">43c265008fae:</span><span style="color:#9ECBFF"> Pull</span><span style="color:#9ECBFF"> complete</span></span>
<span class="line"><span style="color:#B392F0">50baea060b67:</span><span style="color:#9ECBFF"> Pull</span><span style="color:#9ECBFF"> complete</span></span>
<span class="line"><span style="color:#B392F0">5f3e0aed5ee6:</span><span style="color:#9ECBFF"> Pull</span><span style="color:#9ECBFF"> complete</span></span>
<span class="line"><span style="color:#B392F0">80c73fc9483b:</span><span style="color:#9ECBFF"> Pull</span><span style="color:#9ECBFF"> complete</span></span>
<span class="line"><span style="color:#B392F0">Digest:</span><span style="color:#9ECBFF"> sha256:83513a532bc3cfc09ddc44e9c12b9283ace37736fed29f6259cb2b98a1342ab3</span></span>
<span class="line"><span style="color:#B392F0">Status:</span><span style="color:#9ECBFF"> Downloaded</span><span style="color:#9ECBFF"> newer</span><span style="color:#9ECBFF"> image</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> cyrilbouvier/cado-nfs.py:latest</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> Using</span><span style="color:#9ECBFF"> default</span><span style="color:#9ECBFF"> parameter</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> /cado-nfs/share/cado-nfs-2.2.1/factor/params.c155</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> No</span><span style="color:#9ECBFF"> database</span><span style="color:#9ECBFF"> exists</span><span style="color:#9ECBFF"> yet</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> Created</span><span style="color:#9ECBFF"> temporary</span><span style="color:#9ECBFF"> directory</span><span style="color:#9ECBFF"> /tmp/cado.gcsugjj0</span></span>
<span class="line"><span style="color:#B392F0">Info:Database:</span><span style="color:#9ECBFF"> Opened</span><span style="color:#9ECBFF"> connection</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> database</span><span style="color:#9ECBFF"> /tmp/cado.gcsugjj0/c155.db</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> Set</span><span style="color:#9ECBFF"> tasks.threads=</span><span style="color:#79B8FF">6</span><span style="color:#9ECBFF"> based</span><span style="color:#9ECBFF"> on</span><span style="color:#9ECBFF"> detected</span><span style="color:#9ECBFF"> physical</span><span style="color:#9ECBFF"> cpus</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> tasks.polyselect.threads</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 2</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> tasks.sieve.las.threads</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 2</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> slaves.scriptpath</span><span style="color:#9ECBFF"> is</span><span style="color:#9ECBFF"> /cado-nfs/bin</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> Command</span><span style="color:#9ECBFF"> line</span><span style="color:#9ECBFF"> parameters:</span><span style="color:#9ECBFF"> /cado-nfs/bin/cado-nfs.py</span><span style="color:#79B8FF"> 2201913424082091631781416976360711801546418226612701825805464261729388614872096293260765941335270405591230469600688971077042627869124706949973008545385962</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> If</span><span style="color:#9ECBFF"> this</span><span style="color:#9ECBFF"> computation</span><span style="color:#9ECBFF"> gets</span><span style="color:#9ECBFF"> interrupted,</span><span style="color:#9ECBFF"> it</span><span style="color:#9ECBFF"> can</span><span style="color:#9ECBFF"> be</span><span style="color:#9ECBFF"> resumed</span><span style="color:#9ECBFF"> with</span><span style="color:#9ECBFF"> /cado-nfs/bin/cado-nfs.py</span><span style="color:#9ECBFF"> /tmp/cado.gcsugjj0/c155.parameters_snapshot.0</span></span>
<span class="line"><span style="color:#B392F0">Info:Server</span><span style="color:#9ECBFF"> Launcher:</span><span style="color:#9ECBFF"> Adding</span><span style="color:#9ECBFF"> e13824a36734</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> whitelist</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> allow</span><span style="color:#9ECBFF"> clients</span><span style="color:#9ECBFF"> on</span><span style="color:#9ECBFF"> localhost</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> connect</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> Using</span><span style="color:#9ECBFF"> non-threaded</span><span style="color:#9ECBFF"> HTTPS</span><span style="color:#9ECBFF"> server</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> Using</span><span style="color:#9ECBFF"> whitelist:</span><span style="color:#9ECBFF"> localhost,e13824a36734</span></span>
<span class="line"><span style="color:#B392F0">Info:Complete</span><span style="color:#9ECBFF"> Factorization:</span><span style="color:#9ECBFF"> Factoring</span><span style="color:#79B8FF"> 2201913424082091631781416976360711801546418226612701825805464261729388614872096293260765941335270405591230469600688971077042627869124706949973008545385962</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> serving</span><span style="color:#9ECBFF"> at</span><span style="color:#9ECBFF"> https://e13824a36734:41869</span><span style="color:#E1E4E8"> (0.0.0.0)</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> For</span><span style="color:#9ECBFF"> debugging</span><span style="color:#9ECBFF"> purposes,</span><span style="color:#9ECBFF"> the</span><span style="color:#9ECBFF"> URL</span><span style="color:#9ECBFF"> above</span><span style="color:#9ECBFF"> can</span><span style="color:#9ECBFF"> be</span><span style="color:#9ECBFF"> accessed</span><span style="color:#9ECBFF"> if</span><span style="color:#9ECBFF"> the</span><span style="color:#9ECBFF"> server.only_registered=False</span><span style="color:#9ECBFF"> parameter</span><span style="color:#9ECBFF"> is</span><span style="color:#9ECBFF"> added</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> You</span><span style="color:#9ECBFF"> can</span><span style="color:#9ECBFF"> start</span><span style="color:#9ECBFF"> additional</span><span style="color:#9ECBFF"> cado-nfs-client.py</span><span style="color:#9ECBFF"> scripts</span><span style="color:#9ECBFF"> with</span><span style="color:#9ECBFF"> parameters:</span><span style="color:#79B8FF"> --server=https://e13824a36734:41869</span><span style="color:#79B8FF"> --certsha1=313aa0820967f6db061e8fc9cbf2bde7ecdacab5</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> If</span><span style="color:#9ECBFF"> you</span><span style="color:#9ECBFF"> want</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> start</span><span style="color:#9ECBFF"> additional</span><span style="color:#9ECBFF"> clients,</span><span style="color:#9ECBFF"> remember</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> add</span><span style="color:#9ECBFF"> their</span><span style="color:#9ECBFF"> hosts</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> server.whitelist</span></span>
<span class="line"><span style="color:#B392F0">Info:Client</span><span style="color:#9ECBFF"> Launcher:</span><span style="color:#9ECBFF"> Starting</span><span style="color:#9ECBFF"> client</span><span style="color:#9ECBFF"> id</span><span style="color:#9ECBFF"> localhost</span><span style="color:#9ECBFF"> on</span><span style="color:#9ECBFF"> host</span><span style="color:#9ECBFF"> localhost</span></span>
<span class="line"><span style="color:#B392F0">Info:Client</span><span style="color:#9ECBFF"> Launcher:</span><span style="color:#9ECBFF"> Starting</span><span style="color:#9ECBFF"> client</span><span style="color:#9ECBFF"> id</span><span style="color:#9ECBFF"> localhost+2</span><span style="color:#9ECBFF"> on</span><span style="color:#9ECBFF"> host</span><span style="color:#9ECBFF"> localhost</span></span>
<span class="line"><span style="color:#B392F0">Info:Client</span><span style="color:#9ECBFF"> Launcher:</span><span style="color:#9ECBFF"> Starting</span><span style="color:#9ECBFF"> client</span><span style="color:#9ECBFF"> id</span><span style="color:#9ECBFF"> localhost+3</span><span style="color:#9ECBFF"> on</span><span style="color:#9ECBFF"> host</span><span style="color:#9ECBFF"> localhost</span></span>
<span class="line"><span style="color:#B392F0">Info:Client</span><span style="color:#9ECBFF"> Launcher:</span><span style="color:#9ECBFF"> Running</span><span style="color:#9ECBFF"> clients:</span><span style="color:#9ECBFF"> localhost+3</span><span style="color:#E1E4E8"> (Host </span><span style="color:#9ECBFF">localhost,</span><span style="color:#9ECBFF"> PID</span><span style="color:#79B8FF"> 16</span><span style="color:#E1E4E8">), localhost+2 (</span><span style="color:#B392F0">Host</span><span style="color:#9ECBFF"> localhost,</span><span style="color:#9ECBFF"> PID</span><span style="color:#79B8FF"> 14</span><span style="color:#E1E4E8">), localhost (</span><span style="color:#B392F0">Host</span><span style="color:#9ECBFF"> localhost,</span><span style="color:#9ECBFF"> PID</span><span style="color:#79B8FF"> 12</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Starting</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): 0 polynomials in queue from previous run</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Adding workunit c155_polyselect1_0-1000 to database</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Adding workunit c155_polyselect1_1000-2000 to database</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Adding workunit c155_polyselect1_2000-3000 to database</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">Info:Square</span><span style="color:#9ECBFF"> Root:</span><span style="color:#9ECBFF"> Starting</span></span>
<span class="line"><span style="color:#B392F0">Info:Square</span><span style="color:#9ECBFF"> Root:</span><span style="color:#9ECBFF"> Creating</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> of</span><span style="color:#E1E4E8"> (a,b) values</span></span>
<span class="line"><span style="color:#B392F0">Info:Square</span><span style="color:#9ECBFF"> Root:</span><span style="color:#9ECBFF"> finished</span></span>
<span class="line"><span style="color:#B392F0">Info:Square</span><span style="color:#9ECBFF"> Root:</span><span style="color:#9ECBFF"> Factors:</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 79</span><span style="color:#79B8FF"> 104569920747</span><span style="color:#F97583">&#x3C;</span><span style="color:#9ECBFF">hidde</span><span style="color:#E1E4E8">n</span><span style="color:#F97583">></span><span style="color:#9ECBFF">8189807</span><span style="color:#79B8FF"> 43</span><span style="color:#79B8FF"> 31</span></span>
<span class="line"><span style="color:#B392F0">Info:Square</span><span style="color:#9ECBFF"> Root:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> sqrt:</span><span style="color:#9ECBFF"> 0.02/0.0144372</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Aggregate statistics:</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): potential collisions: 71168.8</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): raw lognorm (</span><span style="color:#B392F0">nr/min/av/max/std</span><span style="color:#E1E4E8">): 72294/45.370/55.413/60.780/0.874</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): optimized lognorm (</span><span style="color:#B392F0">nr/min/av/max/std</span><span style="color:#E1E4E8">): 67782/45.250/50.101/56.280/1.689</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): 10 best raw logmu:</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): 10 best opt logmu:</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (size </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Total time: 49493.9</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (root </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Aggregate statistics:</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (root </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Total time: 4050.98</span></span>
<span class="line"><span style="color:#B392F0">Info:Polynomial</span><span style="color:#9ECBFF"> Selection</span><span style="color:#E1E4E8"> (root </span><span style="color:#9ECBFF">optimized</span><span style="color:#E1E4E8">): Rootsieve time: 4050.39</span></span>
<span class="line"><span style="color:#B392F0">Info:Generate</span><span style="color:#9ECBFF"> Factor</span><span style="color:#9ECBFF"> Base:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> makefb:</span><span style="color:#9ECBFF"> 21.54/5.23901</span></span>
<span class="line"><span style="color:#B392F0">Info:Generate</span><span style="color:#9ECBFF"> Free</span><span style="color:#9ECBFF"> Relations:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> freerel:</span><span style="color:#9ECBFF"> 271.45/44.1077</span></span>
<span class="line"><span style="color:#B392F0">Info:Lattice</span><span style="color:#9ECBFF"> Sieving:</span><span style="color:#9ECBFF"> Aggregate</span><span style="color:#9ECBFF"> statistics:</span></span>
<span class="line"><span style="color:#B392F0">Info:Lattice</span><span style="color:#9ECBFF"> Sieving:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> number</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> relations:</span><span style="color:#79B8FF"> 48074999</span></span>
<span class="line"><span style="color:#B392F0">Info:Lattice</span><span style="color:#9ECBFF"> Sieving:</span><span style="color:#9ECBFF"> Average</span><span style="color:#9ECBFF"> J:</span><span style="color:#79B8FF"> 7752.25</span><span style="color:#9ECBFF"> for</span><span style="color:#79B8FF"> 1680511</span><span style="color:#9ECBFF"> special-q,</span><span style="color:#9ECBFF"> max</span><span style="color:#9ECBFF"> bucket</span><span style="color:#9ECBFF"> fill:</span><span style="color:#79B8FF"> 0.732933</span></span>
<span class="line"><span style="color:#B392F0">Info:Lattice</span><span style="color:#9ECBFF"> Sieving:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> CPU</span><span style="color:#9ECBFF"> time:</span><span style="color:#9ECBFF"> 2.90978e+06s</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Duplicate</span><span style="color:#9ECBFF"> Removal,</span><span style="color:#9ECBFF"> splitting</span><span style="color:#9ECBFF"> pass:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> dup1:</span><span style="color:#9ECBFF"> 104.66/78.7711</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Duplicate</span><span style="color:#9ECBFF"> Removal,</span><span style="color:#9ECBFF"> splitting</span><span style="color:#9ECBFF"> pass:</span><span style="color:#9ECBFF"> Aggregate</span><span style="color:#9ECBFF"> statistics:</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Duplicate</span><span style="color:#9ECBFF"> Removal,</span><span style="color:#9ECBFF"> splitting</span><span style="color:#9ECBFF"> pass:</span><span style="color:#9ECBFF"> CPU</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> dup1:</span><span style="color:#9ECBFF"> 78.7s</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Duplicate</span><span style="color:#9ECBFF"> Removal,</span><span style="color:#9ECBFF"> removal</span><span style="color:#9ECBFF"> pass:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> dup2:</span><span style="color:#9ECBFF"> 641.15/153.957</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Singleton</span><span style="color:#9ECBFF"> removal:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> purge:</span><span style="color:#9ECBFF"> 427.7/143.297</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Merging:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> merge:</span><span style="color:#9ECBFF"> 631.74/620.553</span></span>
<span class="line"><span style="color:#B392F0">Info:Filtering</span><span style="color:#9ECBFF"> -</span><span style="color:#9ECBFF"> Merging:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> replay:</span><span style="color:#9ECBFF"> 103.78/94.0045</span></span>
<span class="line"><span style="color:#B392F0">Info:Linear</span><span style="color:#9ECBFF"> Algebra:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> bwc:</span><span style="color:#9ECBFF"> 160799/0.000371933</span></span>
<span class="line"><span style="color:#B392F0">Info:Linear</span><span style="color:#9ECBFF"> Algebra:</span><span style="color:#9ECBFF"> Aggregate</span><span style="color:#9ECBFF"> statistics:</span></span>
<span class="line"><span style="color:#B392F0">Info:Linear</span><span style="color:#9ECBFF"> Algebra:</span><span style="color:#9ECBFF"> Krylov:</span><span style="color:#9ECBFF"> WCT</span><span style="color:#9ECBFF"> time</span><span style="color:#79B8FF"> 18123.13</span></span>
<span class="line"><span style="color:#B392F0">Info:Linear</span><span style="color:#9ECBFF"> Algebra:</span><span style="color:#9ECBFF"> Lingen</span><span style="color:#9ECBFF"> CPU</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> 379.27,</span><span style="color:#9ECBFF"> WCT</span><span style="color:#9ECBFF"> time</span><span style="color:#79B8FF"> 81.51</span></span>
<span class="line"><span style="color:#B392F0">Info:Linear</span><span style="color:#9ECBFF"> Algebra:</span><span style="color:#9ECBFF"> Mksol:</span><span style="color:#9ECBFF"> WCT</span><span style="color:#9ECBFF"> time</span><span style="color:#79B8FF"> 9798.28</span></span>
<span class="line"><span style="color:#B392F0">Info:Quadratic</span><span style="color:#9ECBFF"> Characters:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> characters:</span><span style="color:#9ECBFF"> 78.49/28.6099</span></span>
<span class="line"><span style="color:#B392F0">Info:Square</span><span style="color:#9ECBFF"> Root:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/real</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> sqrt:</span><span style="color:#9ECBFF"> 0.02/0.0144372</span></span>
<span class="line"><span style="color:#B392F0">Info:HTTP</span><span style="color:#9ECBFF"> server:</span><span style="color:#9ECBFF"> Shutting</span><span style="color:#9ECBFF"> down</span><span style="color:#9ECBFF"> HTTP</span><span style="color:#9ECBFF"> server</span></span>
<span class="line"><span style="color:#B392F0">Info:Complete</span><span style="color:#9ECBFF"> Factorization:</span><span style="color:#9ECBFF"> Total</span><span style="color:#9ECBFF"> cpu/elapsed</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> entire</span><span style="color:#9ECBFF"> factorization:</span><span style="color:#9ECBFF"> 3.12641e+06/720361</span></span>
<span class="line"><span style="color:#B392F0">Info:root:</span><span style="color:#9ECBFF"> Cleaning</span><span style="color:#9ECBFF"> up</span><span style="color:#9ECBFF"> computation</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> in</span><span style="color:#9ECBFF"> /tmp/cado.06lc2ugg</span></span>
<span class="line"><span style="color:#B392F0">2</span><span style="color:#79B8FF"> 79</span><span style="color:#79B8FF"> 104569920747</span><span style="color:#F97583">&#x3C;</span><span style="color:#9ECBFF">hidde</span><span style="color:#E1E4E8">n</span><span style="color:#F97583">></span><span style="color:#9ECBFF">8189807</span><span style="color:#79B8FF"> 43</span><span style="color:#79B8FF"> 31</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Unfortunately that's as far as I got :)</span></span></code></pre>
<h1 id="dynamic-instrumentation--reversing---c-apps">Dynamic Instrumentation &#x26; Reversing - C# apps</h1>
<p>One word: <a href="https://github.com/dnSpy/dnSpy">dnSpy</a>. Again, a gift given by gods. Unfortunately frida won‚Äôt work with the C# runtime but dnSpy has your back. It fully decompiles the app and is an amazing debugger.</p>
<p>The exact same principals as above apply but the problem is that the resulting crack can‚Äôt be a javascript file and this raises a problem that I‚Äôve been obsessing about for the past two weeks: Crack deployment.</p>
<p>As I said in the prologue, I like clean cracks that are transparent to the user (can inspect them easily) and are able to be maintained for future proofing. JavaScript is an amazing solution to the above problems (although it has some others of its own) but as frida isn‚Äôt available for C#, we can‚Äôt use it. Of course we could patch the binary with dnSpy but patched binaries just don‚Äôt cut it for me. They‚Äôre dirty. We‚Äôll talk about this problem later.</p>
<h1 id="dynamic-instrumentation--reversing---java-apps">Dynamic Instrumentation &#x26; Reversing - Java apps</h1>
<p>Well here, we‚Äôve got a problem. I was stunned to find out that the main target of frida, the Java VM is actually the mobile Java VM. Frida-ing ‚ÄúRegular‚Äù Java, running on Windows and Linux won‚Äôt do it. It spits out some errors about some not found classes (that contain the name <code>Zygote</code> which is an Android-y name) and doesn‚Äôt work. I was heart broken and at that point I didn‚Äôt go any further.</p>
<p>Of course there‚Äôs JadX for reversing, but it doesn‚Äôt offer a debugger for desktop apps either. Why does everyone forget that Java runs on desktops, is above me.</p>
<p>Maybe I‚Äôll come around it and find good tooling around Java, who knows. If you happen to know good tools, leave a comment below</p>
<h1 id="crack-deployment">Crack deployment</h1>
<p>As we‚Äôre reaching the end of this post (yes, it has one, even if it doesn‚Äôt seem like it) I‚Äôd like to close with the problem I‚Äôve been burdened for the last two weeks. Let‚Äôs say I‚Äôve written some good frida scripts that do their job and I‚Äôve patched a C# DLL as a PoC. Now what? I don‚Äôt want to have to run the app through frida and have a statically patched binary! That‚Äôs dirty! When the app updates, I‚Äôll have problems. I break the PE‚Äôs signature, it‚Äôs hard to replicate, it‚Äôs hard to explain and it‚Äôs not transparent. I‚Äôve found the following solutions till now - unfortunately without a good implementation (yet?):</p>
<ul>
<li>Create an AppInit_DLL (for what that is click <a href="https://learn.microsoft.com/en-us/windows/win32/dlls/secure-boot-and-appinit-dlls#about-appinit_dlls">here</a>) that is app-aware so that when <code>MyApp.exe</code> loads <code>user32.dll</code> <a href="https://frida.re/docs/gadget/">frida-gadget</a> can be injected or a nicely written Rust dll can be injected. I‚Äôve not seen a tool like this but I‚Äôd like to develop one.</li>
<li>Patch the target exe to include our custom frida-gadget/DLL as a DLL import and load it. This differs than static patching as there‚Äôs a single global script to patch all of our cracked exes and the change is almost self-explanatory. When the exe is cracked, it‚Äôll have a <code>libcrack.dll</code> import that does all the hooking job. Simple and clean - with an asterisk though as that change breaks the PE‚Äôs signature, something that I‚Äôve got no idea how big of a problem is. I‚Äôve tried using the <a href="https://lief-project.github.io/doc/stable/tutorials/06_pe_hooking.html">LIEF</a> python library but I wasn‚Äôt able to run the exe after patching successfully after <a href="https://lief-project.github.io/doc/stable/tutorials/09_frida_lief.html">injecting the frida-gadget library</a> - I‚Äôve even opened an <a href="https://github.com/lief-project/LIEF/issues/777">issue about it</a></li>
<li>Maybe find DLLs that the app optionally searches for and if found load them? That‚Äôs too app-specific though and prone to break across updates (maybe it requires different exports or it changes the program behavior in a way that we don‚Äôt like).</li>
<li>??? - please comment if you have a good idea</li>
</ul>
<h1 id="closing">Closing</h1>
<p>I still don‚Äôt get why companies charge such a stupid amount of money for their software when we‚Äôre talking about hobbyist clients. It‚Äôs a win-win. You‚Äôll never make a 50k$/year sale to that person but if you give it to them for free, it‚Äôs almost sure that they‚Äôre gonna root for you and advertise you. For free. Also if they land a job around the market you‚Äôre in, there‚Äôs a pretty good chance that they‚Äôll push the company to buy your software - even for 50k/year.</p>
<p>Maybe I‚Äôm too naive. Maybe I ‚Äúdon‚Äôt get business‚Äù. Truth is, I‚Äôm not good at that ‚Äúcapitalism‚Äù game.</p>
<p>On the other hand, I tend to draw a line on apps that I crack. There are some amazing software that cost something very reasonable and they get regular updates, good communities n stuff. I like to support them if I can.</p>
<p>In any case, cracking is not that hard, it just requires time. You get to dead ends quite often but it‚Äôs not hard to understand what you see. Most times, when I‚Äôm stuck I start from a new lead. Eventually everything falls together. Give or take, a month is enough to crack ‚Äúmost‚Äù programs (I‚Äôm not talking about apps around computer security, such as IDA Pro. I‚Äôve heard it‚Äôs a HUGE undertaking).</p>  </div> <footer class="post-footer" data-astro-cid-gjtny2mx> <div class="footer-sep" aria-hidden="true" data-astro-cid-gjtny2mx></div> <div class="author-card" data-astro-cid-gjtny2mx> <img src="https://www.gravatar.com/avatar/c9ccfe62d2de0aebdb79a1e7cf5c7019?s=100&d=identicon" alt="dzervas" class="author-avatar" width="64" height="64" data-astro-cid-gjtny2mx> <div class="author-info" data-astro-cid-gjtny2mx> <p class="author-label" data-astro-cid-gjtny2mx>// written_by</p> <p class="author-name" data-astro-cid-gjtny2mx>dzervas</p> <p class="author-bio" data-astro-cid-gjtny2mx>Creator of this site and lover of fails.</p> </div> </div> </footer> </article>  </main> <footer class="site-footer" data-astro-cid-sz7xmlte> <div class="footer-separator" aria-hidden="true" data-astro-cid-sz7xmlte></div> <div class="footer-inner" data-astro-cid-sz7xmlte> <div class="footer-main" data-astro-cid-sz7xmlte> <nav class="footer-social" aria-label="Social links" data-astro-cid-sz7xmlte> <ul class="social-list" data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte> <a href="https://kafeneio.social/@dzervas" class="social-link" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-mastodon "><path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.432 4.014.535c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.41 2.405 1.228l.518.869.519-.869c.533-.818 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558z"/></svg> <span class="social-label" data-astro-cid-sz7xmlte>Mastodon</span> </a> </li><li data-astro-cid-sz7xmlte> <a href="https://github.com/dzervas/whynot.fail" class="social-link" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github "><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg> <span class="social-label" data-astro-cid-sz7xmlte>GitHub</span> </a> </li><li data-astro-cid-sz7xmlte> <a href="/rss.xml" class="social-link" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-rss "><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg> <span class="social-label" data-astro-cid-sz7xmlte>RSS Feed</span> </a> </li> </ul> </nav> </div> </div> </footer>  <nav class="webring" aria-label="Webring"> <a class="webring-link edge-link webring-link--prev" href="https://webring.stavros.io/prev"> <span class="webring-arrow" aria-hidden="true">&lt;</span> <span class="webring-label">Previous blog</span> </a> <a class="webring-link edge-link webring-link--next" href="https://webring.stavros.io/next"> <span class="webring-arrow" aria-hidden="true">&gt;</span> <span class="webring-label">Next blog</span> </a> </nav> <a class="back-to-top edge-link" href="#top" data-back-to-top> <span class="webring-arrow back-to-top-arrow" aria-hidden="true">^</span> <span class="webring-label back-to-top-label">Top</span> </a> </div> <div class="search-overlay" data-search-overlay hidden> <div class="search-backdrop" data-search-close></div> <div class="search-panel" role="dialog" aria-modal="true" aria-label="Search"> <header class="search-header"> <input type="search" class="search-input" placeholder="Search posts..." aria-label="Search posts" data-search-input> <button class="search-close" type="button" aria-label="Close search" data-search-close>
&times;
</button> </header> <div class="search-results" data-search-results> <p class="search-empty">Type something and hit Enter. Or just panic.</p> </div> </div> </div>  <script type="module">const e=document.querySelector("[data-back-to-top]"),t=document.querySelector(".site-footer"),r=()=>{e instanceof HTMLElement&&e.toggleAttribute("data-visible",window.scrollY>240)},o=()=>{if(!(e instanceof HTMLElement)||!(t instanceof HTMLElement))return;const n=t.getBoundingClientRect().height;e.style.setProperty("--footer-height",`${n}px`)};r();o();window.addEventListener("scroll",r,{passive:!0});window.addEventListener("resize",o,{passive:!0});window.addEventListener("load",o,{passive:!0});t&&new ResizeObserver(o).observe(t);</script> <script type="module">const y={cdnUrl:"https://cdn.jsdelivr.net/npm/lunr/lunr.min.js"},c=document.querySelector("[data-search-overlay]"),r=document.querySelector("[data-search-results]"),i=document.querySelector("[data-search-input]"),w=document.querySelectorAll("[data-search-close]"),g=document.querySelector("[data-search-trigger]");c&&(c.hidden=!0);let l=null,u=[],o=null,s=-1;const L=()=>new Promise((e,t)=>{if(window.lunr){e(window.lunr);return}const n=document.createElement("script");n.src=y.cdnUrl,n.async=!0,n.onload=()=>{window.lunr?e(window.lunr):t(new Error("Lunr CDN loaded without window.lunr"))},n.onerror=()=>t(new Error("Failed to load Lunr CDN")),document.head.appendChild(n)}),E=async()=>o||(o=await L(),o),k=e=>e.length===0?'<p class="search-empty">No matches. Try a different incantation.</p>':(e.length>10?e.slice(0,10):e).map((n,a)=>{const d=n.tags.slice(0,3).map(m=>`<span class="search-tag">${m}</span>`).join("");return`
        <a class="search-item${a===s?" is-active":""}" data-search-item href="${n.slug}">
          <span class="search-title">${n.title}</span>
          <span class="search-description">${n.description}</span>
          <span class="search-tags">${d}</span>
        </a>
      `}).join(""),p=()=>{!c||!i||(c.hidden=!1,document.body.classList.add("search-open"),i.value="",s=-1,r&&(r.innerHTML='<p class="search-empty">Type something and hit Enter. Or just panic.</p>'),window.setTimeout(()=>i.focus(),0))},h=()=>{c&&(c.hidden=!0,document.body.classList.remove("search-open"))},v=async()=>{if(l)return;u=await(await fetch("/search.json")).json(),l=(await E())(function(){this.ref("slug"),this.field("title"),this.field("description"),this.field("tags"),this.field("category"),u.forEach(n=>this.add(n))})},A=async e=>{if(!r)return[];if(await v(),!l)return[];const n=l.search(e).slice(0,25).map(a=>u.find(d=>d.slug===a.ref)).filter(a=>!!a);return r.innerHTML=k(n),n},f=e=>{if(!r)return;const t=Array.from(r.querySelectorAll("[data-search-item]"));t.length!==0&&(s=(s+e+t.length)%t.length,t.forEach((n,a)=>{n.classList.toggle("is-active",a===s)}),t[s].scrollIntoView({block:"nearest"}))},C=()=>{if(!r)return;const e=Array.from(r.querySelectorAll("[data-search-item]"));e.length===0||s<0||e[s].click()},S=e=>{if((e.metaKey||e.ctrlKey)&&e.key.toLowerCase()==="k"){e.preventDefault(),p();return}if(e.key==="Escape"){h();return}!c||c.hidden||((e.key==="ArrowDown"||e.key.toLowerCase()==="j")&&(e.preventDefault(),f(1)),(e.key==="ArrowUp"||e.key.toLowerCase()==="k")&&(e.preventDefault(),f(-1)),e.key==="Enter"&&(e.preventDefault(),C()))};i&&i.addEventListener("input",e=>{const t=e.target.value.trim();if(t.length===0){s=-1,r&&(r.innerHTML='<p class="search-empty">Type something and hit Enter. Or just panic.</p>');return}A(t).then(()=>{s=-1,r&&r.querySelectorAll("[data-search-item]").forEach(a=>a.classList.remove("is-active"))})});w.forEach(e=>e.addEventListener("click",h));g?.addEventListener("click",p);document.addEventListener("keydown",S);document.addEventListener("click",e=>{const t=e.target;(t.matches("[data-search-close]")||t.closest("[data-search-close]"))&&h()});const j=document.documentElement;j.classList.add("js-enabled");</script> </body> </html>  