<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Cause when you fail, somebody has to laugh at you"><title>Making PCBs at home: Milling the first layer (and why you need it) | WhyNot.Fail</title><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Raleway:wght@400;500;600;700&display=swap" rel="stylesheet"><!-- Favicon --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="WhyNot.Fail RSS" href="/rss.xml"><style>.tag-list[data-astro-cid-lga65v7i]{display:flex;flex-wrap:wrap;gap:.5rem;list-style:none;padding:0;margin:0}.tag[data-astro-cid-lga65v7i]{display:inline-block;padding:.25rem .625rem;font-size:.8125rem;font-weight:500;text-decoration:none;color:var(--color-accent);background:var(--color-accent-bg);border:1px solid var(--color-accent-border);border-radius:4px;transition:all .15s ease}.tag[data-astro-cid-lga65v7i]:hover{background:var(--color-accent);color:var(--color-bg);border-color:var(--color-accent)}.build-badge[data-astro-cid-mzimu5gx]{display:inline-flex;align-items:center;font-family:JetBrains Mono,monospace;font-size:.8125rem;letter-spacing:.02em}.badge-prefix[data-astro-cid-mzimu5gx]{color:var(--color-text-muted)}.badge-status[data-astro-cid-mzimu5gx]{font-weight:600}.badge-passing[data-astro-cid-mzimu5gx] .badge-status[data-astro-cid-mzimu5gx]{color:var(--color-success)}.badge-failing[data-astro-cid-mzimu5gx] .badge-status[data-astro-cid-mzimu5gx]{color:var(--color-danger)}.badge-unknown[data-astro-cid-mzimu5gx] .badge-status[data-astro-cid-mzimu5gx]{color:var(--color-warning)}
</style>
<link rel="stylesheet" href="/_astro/_slug_.BSLznIs-.css">
<link rel="stylesheet" href="/_astro/_slug_.ClLXJwUM.css"></head> <body id="top"> <div class="site-wrapper"> <header class="site-header" data-astro-cid-3ef6ksr2> <div class="header-inner" data-astro-cid-3ef6ksr2> <a href="/" class="logo" aria-label="WhyNot.Fail" data-astro-cid-3ef6ksr2> <pre class="ascii-logo" aria-hidden="true" data-astro-cid-3ef6ksr2>
 █   █ █ █ █ █ █▄ █ █▀█ ▀█▀
 █▄█▄█ █▀█ ▀█▀ █ ▀█ █▄█  █
        ·FAIL·
      </pre> <span class="logo-tagline" data-astro-cid-3ef6ksr2>// cause_when_you_fail_somebody_has_to_laugh_at_you</span> </a> <div class="header-actions" data-astro-cid-3ef6ksr2> <nav class="nav-main" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-cid-3ef6ksr2> Home </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about/" class="nav-link" data-astro-cid-3ef6ksr2> About </a> </li><li data-astro-cid-3ef6ksr2> <a href="/tags/" class="nav-link" data-astro-cid-3ef6ksr2> Tags </a> </li> </ul> </nav> <div class="search-shell" data-search-trigger data-astro-cid-3ef6ksr2> <input type="search" class="search-trigger" placeholder="Search" aria-label="Open search" readonly data-astro-cid-3ef6ksr2> <span class="search-shortcut" data-astro-cid-3ef6ksr2>Ctrl+K</span> </div> </div> </div> <div class="header-separator" aria-hidden="true" data-astro-cid-3ef6ksr2></div> </header>  <main class="main-content">  <article class="post" data-astro-cid-gjtny2mx> <header class="post-header" data-astro-cid-gjtny2mx> <div class="post-header-top" data-astro-cid-gjtny2mx> <a href="/" class="back-link" data-astro-cid-gjtny2mx> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-arrow-left "><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg> <span data-astro-cid-gjtny2mx>Back to posts</span> </a>  </div> <div class="post-meta" data-astro-cid-gjtny2mx> <time datetime="2021-09-05T00:00:00.000Z" data-astro-cid-gjtny2mx>05 September 2021</time> <span class="meta-sep" data-astro-cid-gjtny2mx>/</span> <span class="post-author" data-astro-cid-gjtny2mx>dzervas</span>  <span class="meta-sep" data-astro-cid-gjtny2mx>/</span> <span class="build-badge badge-passing" data-astro-cid-mzimu5gx> <span class="badge-prefix" data-astro-cid-mzimu5gx>build:</span> <span class="badge-status" data-astro-cid-mzimu5gx>[PASS]</span> </span>   </div> <h1 class="post-title" data-astro-cid-gjtny2mx>Making PCBs at home: Milling the first layer (and why you need it)</h1> <div class="post-tags" data-astro-cid-gjtny2mx> <ul class="tag-list" data-astro-cid-lga65v7i><li data-astro-cid-lga65v7i><a href="/tags/factory/" class="tag" data-astro-cid-lga65v7i>factory</a></li><li data-astro-cid-lga65v7i><a href="/tags/hardware/" class="tag" data-astro-cid-lga65v7i>hardware</a></li><li data-astro-cid-lga65v7i><a href="/tags/embedded/" class="tag" data-astro-cid-lga65v7i>embedded</a></li></ul> </div> </header> <div class="post-hero" data-astro-cid-gjtny2mx> <img src="/images/notion-8daeb538-9700-4353-b57b-6a578f167e6b-camphoto_1902445306_cropped.jpg" alt="Making PCBs at home: Milling the first layer (and why you need it)" loading="lazy" data-astro-cid-gjtny2mx> </div> <div class="post-content" data-astro-cid-gjtny2mx>  <p>For the past 5 years I’ve been obsessed about finding a super quick way to make hobby-grade PCBs at home. The race I was looking to win was the “I don’t want to wait 3 weeks being able to do nothing after I remembered that I2C needs in-series resistors”. I want to get my board in my hands in about an hour without doing much.</p>
<p>And I found the way, but most importantly, I found the workflow. Let me show you!</p>
<p>First of all, in case you missed the title, my solution is CNC milling. The upfront cost is quite budget friendly (less than 200 euros), no nasty chemicals are involved and you can safely toss that awfully bad “PCB drill” out the window. The process takes about 30’ of which 5 are manual labor (preparing gcode and toolchanging)</p>
<h2 id="required-tools">Required tools</h2>
<p>While not on the “simple” side, the tools that are required are cheap and can sit on your workbench.</p>
<ul>
<li>A CNC. Almost any CNC. If you’re a cheap fuck, a CNC 3018 will cut it (I recommend <a href="https://www.sainsmart.com/products/sainsmart-genmitsu-cnc-router-3018-prover-kit">this</a>). The requirements for the CNC are the following:</li>
<li>Some way to hold the copper clad safely on the CNC - clamps/screws/whatever</li>
<li>A 60° 0.1mm-0.2mm endmill to mill the traces (I recommend <a href="https://www.banggood.com/Drillpro-10pcs-0_10_20_30_40_5mm-45-Degree-Flat-Bottom-PCB-Engraving-Bit-Blue-NANO-Coated-Carbide-CNC-Router-Tool-p-1421668.html?rmmds=myorder&#x26;cur_warehouse=CN&#x26;ID=512928">this</a> set of 10 at 0.2mm)</li>
<li>A 1mm PCB endmill to cut the board and milldrill (called fishtail? I recommend <a href="https://www.banggood.com/10pcs-11_522_53mm-Carbide-End-Mill-Cutter-PCB-Drill-Bits-p-1090388.html?rmmds=myorder&#x26;cur_warehouse=CN">this</a> set)</li>
<li>A set of PCB drill bits bellow 1mm (there are many on bg)</li>
<li>Some single sided copper clad - just make sure it fits on your CNC (source it locally or through bg)
The CNC costs ~250 euros and the consumables ~30. You can find even cheaper CNCs but the sainsmart is quite common and has a community. It’s bad as it is (you won’t be cutting aluminum anytime soon) so you definitely want some people to help you. CNCing is generally hard - apart from PCBs, PCBs are easy and hassle free.</li>
</ul>
<h2 id="software-preparation">Software Preparation</h2>
<p>You’re gonna need the following software setup and working:</p>
<ul>
<li><a href="https://github.com/pcb2gcode/pcb2gcode">pcb2gcode</a> - to generate G-Code from gerbers</li>
<li><a href="https://github.com/vlachoudis/bCNC/">bCNC</a> - G-Code sender that has autoleveling feature</li>
<li>The gerbers of the board you wanna make - these should have all the traces on the <strong>BACK</strong> side</li>
</ul>
<h2 id="workflow">Workflow</h2>
<p>The whole idea is the following:</p>
<ol>
<li>Create gcode from gerbers after some setup (speeds &#x26; feeds). The gcode is split in the following files:</li>
<li>Load <code>back</code> file on bCNC</li>
<li>Connect the probe leads to the cutter and the board</li>
<li>Zero X &#x26; Y so that the board fits on the stock and Z roughly 2mm above the board</li>
<li>Set Z 0 (again) in the origin by going to <code>Probe tab -> Probe</code>, Configure <code>Pos: 0, 0, -3</code> and press <code>Probe</code> button. The spindle will start going down very slowly until it touches the board. Press <code>Z=0</code>.</li>
<li>Without lifting the Z, go to <code>Autolevel</code> button and press the <code>Zero</code> button with the crosshairs.</li>
<li>Lift Z to ~5mm and go back to <code>Probe tab -> Autolevel</code></li>
<li>Start autolevel probing by:</li>
<li>Start the cut</li>
<li>After it’s finished, load the <code>drill</code> file WITHOUT saving changes to previous file and WITHOUT deleting the probe mesh (it pops up 2 questions that you should both answer with No) and change the tool</li>
<li>Go to XY origin, wipe a bit the point under the cutter and do a regular probe to set the tool’s offset and set <code>Z=0</code> after the probe touches</li>
<li>Start the cut</li>
<li>Repeat steps 10-12 for milldrill and outline</li>
<li>Profit!
To avoid breathing all the fiberglass cut you can have a small syringe filled with water and squirt some as the cuts go. It really helps keep everything super clean.</li>
</ol>
<p>Another idea is to squirt some WD-40 or cutting fluid during the cut - I haven’t tested it but it sounds pretty good and maybe WD-40 isn’t conductive (so you don’t have to wipe it during probing for tool changes). An idea by <a href="https://incoherency.co.uk/blog/">James</a>.</p>
<h2 id="configuring-pcb2gcode">Configuring pcb2gcode</h2>
<p>pcb2gcode requires some configuration to generate correct G-Code for your setup. This can be done either with a gazillion command line flags or through a file, called <code>millproject</code> that has to be on the same directory that the pcb2gcode command is executed. Here is a thoroughly commented <code>millproject</code> for my machine:</p>
<p><code>millproject</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span># Pcb2GCode settings</span></span>
<span class="line"><span>metric=true # Use mm to read the following values (feeds/speeds/etc.), not imperial inches</span></span>
<span class="line"><span>metricoutput=true # Same, but for the output</span></span>
<span class="line"><span>zero-start=true # Start from 0,0,0</span></span>
<span class="line"><span>zsafe=1 # Safety height</span></span>
<span class="line"><span>zchange=5 # Height to change a tool - don't over-do it to avoid crushing your Z axis</span></span>
<span class="line"><span>software=custom # We're not using Mach or LinuxCNC</span></span>
<span class="line"><span>mirror-axis=1 # Mirror the design to X. Required for the back side</span></span>
<span class="line"><span># voronoi=1 # (optional) Instead of cutting straight traces, cut the board only in the places that shouldn't connect with each other. Produces very weird boards but it's quite fast and optimal</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Milling - Trace engraving</span></span>
<span class="line"><span>zwork=-0.07mm # Depth of engraving - did  quite a lot of testing and it seems 0.07 is quite consistent</span></span>
<span class="line"><span>mill-feed=600 # How fast to go, in mm/min - maybe go a bit faster?</span></span>
<span class="line"><span>mill-speed=10000 # How fast to rotate the spindle in RPM</span></span>
<span class="line"><span>mill-diameters=0.30mm # Caluclated by pcb_mill_calc.py - 0.30mm for 0.2mm 60 degree endmill</span></span>
<span class="line"><span>isolation-width=0.55mm # Space between traces - I recommend higher than 0.5mm to be MUCH easier to sold and avoid bridges</span></span>
<span class="line"><span>milling-overlap=20% # How much should the passes to create the isolation width overlap - 20% is good</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Drilling</span></span>
<span class="line"><span>zdrill=-1.7 # Depth to drill a hole, +0.1mm than the board thickness to have clean holes</span></span>
<span class="line"><span>zmilldrill=-1.7 # Same but for milldrill</span></span>
<span class="line"><span>drill-side=back # Drill the board from the back side</span></span>
<span class="line"><span>drill-feed=25 # Lower Z during drilling at 25mm/s - don't go much higher, CNCs don't like drilling</span></span>
<span class="line"><span>drill-speed=10000 # How fast to rotate the spindle in RPM</span></span>
<span class="line"><span>drills-available=0.3mm,0.4mm,0.5mm,0.6mm,0.7mm,0.8mm,0.9mm # Available drill diameters - You "should" have all the diameters smaller than your milldrill bit, if you don't have one it will be rounded to the colsest one you have</span></span>
<span class="line"><span>milldrill-diameter=1.0mm # Diameter of the milldrill endmill - I suggest 1mm as you have much less toolchanges and it lasts quite long</span></span>
<span class="line"><span>min-milldrill-hole-diameter=1.0mm # Minimum diameter to milldrill - should be the same with your milldrill diameter</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Outline</span></span>
<span class="line"><span>zcut=-1.7 # Depth of cut for the outline</span></span>
<span class="line"><span>cut-side=back # Cut the board from the back</span></span>
<span class="line"><span>cut-feed=200 # How fast to cut the board in mm/min - can go a LOT faster I think</span></span>
<span class="line"><span>cut-vertfeed=25 # How fast to plunge into the board - don't go much higher</span></span>
<span class="line"><span>cut-speed=10000 # How fast to run the spindle in RPM</span></span>
<span class="line"><span>cut-infeed=0.85 # Do the cutting in multiple passes, 0.85mm each - maybe this isn't needed</span></span>
<span class="line"><span>cutter-diameter=1.0mm # Diameter of the cutter - use the milldrill bit</span></span>
<span class="line"><span>bridges=4 # Width of each tab to avoid flying PCBs after the outline is done</span></span>
<span class="line"><span>bridgesnum=2 # Number of tabs</span></span>
<span class="line"><span>zbridges=-1.2 # Z height while cutting tabs, -1.2 will result in 0.4mm tabs - 0.4mm is ok</span></span>
<span class="line"><span></span></span>
<span class="line"><span># GRBL shenanigans</span></span>
<span class="line"><span># G64 is not supported by GRBL</span></span>
<span class="line"><span>nog64=true</span></span>
<span class="line"><span># https://github.com/gnea/grbl/issues/290</span></span>
<span class="line"><span>nog81=true</span></span>
<span class="line"><span>nog91-1=true</span></span></code></pre>
<p>While the engraving bit is lets say 0.2mm, you’re cutting 0.07mm lower than the surface so the resulting cut will have a bigger width than 0.2mm. To calculate the effective width of cut I created a python script:</p>
<p><code>pcb_mill_calc.py</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D">#!/usr/bin/env python3</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> math</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># For an example of angle=60 tip=0.2 and depth=0.1 check: https://www.calculator.net/right-triangle-calculator.html?av=0.1&#x26;alphav=60&#x26;alphaunit=d&#x26;bv=&#x26;betav=&#x26;betaunit=d&#x26;cv=&#x26;hv=&#x26;areav=&#x26;perimeterv=&#x26;x=97&#x26;y=22</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> calculate_effective_width</span><span style="color:#E1E4E8">(angle, tip, depth</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0.1</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    rads </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> math.radians((</span><span style="color:#79B8FF">180</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">angle)</span><span style="color:#F97583">/</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> depth </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> math.tan(rads) </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> tip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#79B8FF"> __name__</span><span style="color:#F97583"> ==</span><span style="color:#9ECBFF"> "__main__"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">    import</span><span style="color:#E1E4E8"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    angle </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> float</span><span style="color:#E1E4E8">(sys.argv[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">    tip </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> float</span><span style="color:#E1E4E8">(sys.argv[</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">    depth </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0.1</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        depth </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> float</span><span style="color:#E1E4E8">(sys.argv[</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> IndexError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"For the tip with </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">angle</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> degree angle, </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">tip</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">mm tip and for a </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">depth</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">mm depth of cut, the following effective width should be used:"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> calculate_effective_width(angle, tip, depth)</span></span>
<span class="line"><span style="color:#E1E4E8">    recommended </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> result </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">0.05</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8"> (result </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 0.05</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">\t{</span><span style="color:#E1E4E8">result</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> -> rounded up to 0.05mm (for best results): </span><span style="color:#79B8FF">{round</span><span style="color:#E1E4E8">(recommended, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>Usage: <code>python3 pcb_mill_calc.py &#x3C;bit angle> &#x3C;bit diameter> &#x3C;depth of cut></code></p>
<p>For example to for my 60° 0.2mm endmill with <code>zwork</code> 0.07mm:</p>
<p><code>python3 pcb_mill_calc.py 60 0.2 0.07</code></p>
<p>And I get the following result:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>For the tip with 60.0 degree angle, 0.2mm tip and for a 0.07mm depth of cut, the following effective width should be used:</span></span>
<span class="line"><span>    0.28082903768654766 -> rounded up to 0.05mm (for best results): 0.3</span></span></code></pre>
<p>Oof, that’s it! That’s the hardest part but it needs to be done only once - you can then copy the file around in projects and tinker it a bit.</p>
<h2 id="generate-the-g-code">Generate the G-Code</h2>
<p>The rest is quite easy, execute the following command:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">mkdir</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> /tmp/gcode</span><span style="color:#E1E4E8"> &#x26;&#x26; </span><span style="color:#B392F0">pcb2gcode</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--front</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-CuTop.gbr"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--front-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-front.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--back</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-CuBottom.gbr"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--back-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-back.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--drill</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}.drl"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--drill-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-drill.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--milldrill-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-milldirll.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--outline</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-EdgeCuts.gbr"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--outline-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-outline.ngc"</span></span></code></pre>
<p>It expects gerbers exported by KiCad (due to the <code>CuTop</code> naming convention and the rest) to be under /tmp/gerbers and a variable <code>PROJECT</code> with the name of the KiCad project. If you have indeed a KiCad project, I have an even better command that using <a href="https://github.com/yaqwsx/KiKit">KiKit</a>, generates the gerbers and feeds them to pcb2gcode automatically:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> PROJECT</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">${$(ls </span><span style="color:#F97583">*</span><span style="color:#E1E4E8">.kicad_pcb)</span><span style="color:#F97583">%</span><span style="color:#E1E4E8">.kicad_pcb} &#x26;&#x26; </span><span style="color:#79B8FF">\</span></span>
<span class="line"><span style="color:#B392F0">	kikit</span><span style="color:#9ECBFF"> export</span><span style="color:#9ECBFF"> gerber</span><span style="color:#9ECBFF"> "${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}.kicad_pcb"</span><span style="color:#9ECBFF"> /tmp/gerbers</span><span style="color:#E1E4E8"> &#x26;&#x26; </span><span style="color:#79B8FF">\</span></span>
<span class="line"><span style="color:#B392F0">	mkdir</span><span style="color:#79B8FF"> -p</span><span style="color:#9ECBFF"> /tmp/gcode</span><span style="color:#E1E4E8"> &#x26;&#x26; </span><span style="color:#79B8FF">\</span></span>
<span class="line"><span style="color:#B392F0">	pcb2gcode</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--front</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-CuTop.gbr"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--front-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-front.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--back</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-CuBottom.gbr"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--back-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-back.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--drill</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}.drl"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--drill-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-drill.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--milldrill-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-milldirll.ngc"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--outline</span><span style="color:#9ECBFF"> "/tmp/gerbers/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-EdgeCuts.gbr"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">	--outline-output</span><span style="color:#9ECBFF"> "/tmp/gcode/${</span><span style="color:#E1E4E8">PROJECT</span><span style="color:#9ECBFF">}-outline.ngc"</span></span></code></pre>
<p>Continue to Step 2 from Workflow and you’ll be done in minutes!</p>
<h2 id="the-end">The End</h2>
<p>This was quite a journey for me and it took me about 2 years to finish this workflow. Takes about 30’ to make a small board, it’s almost free. The cutters don’t wear much, copper clads are dirt cheap and widely available even in local stores. The boards turn out amazingly well with almost no post-processing required - maybe some flying copper hair.</p>
<p>I’m already preparing the workflow for a double sided PCB workflow, most probably using a spindle camera (it’s cheap, don’t freak out). Stay tuned.</p>
<p>What I haven’t figured out is how to apply solder mask. It needs a weird spring-loaded tool that is able to remove 0.01-0.02 material. If you have any cool ideas, leave a comment!</p>
<h2 id="alternative-pcb-making-methods">Alternative PCB making methods</h2>
<p>This is a list on ways to make PCBs at home and why I chose milling over everything else:</p>
<ul>
<li>Toner transfer with iron</li>
<li>Plotter marker (have a plotter with a permanent marker on bare copper clad, there’s an awesome guide by Stavros <a href="https://www.stavros.io/posts/make-pcbs-at-home/">here</a>)</li>
<li>Laser engraver (Photosensitive board that is marked by the laser)</li>
<li>CNC Milling</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>I wanna keep this section up-to-date with problems that I stumble upon. If you have any problems, even machine-specific, please leave a comment.</p>
<h3 id="even-after-leveling-i-get-uneven-traces-that-are-too-deep-or-shallow">Even after leveling, I get uneven traces that are too deep or shallow</h3>
<p>First of all, make sure that you didn’t press the small <code>Autolevel</code> button. What this does is apply the autolevel offsets a second time so the result is just like if you hadn’t leveled your workpiece - but from the opposite side</p>
<p>Then, check that your probe wire doesn’t pick up noise from the motors or spindle. You can check this but doing some movement with your machine and watching if a <code>[P]</code> will randomly show in the machine status. If you have this problem read <a href="https://github.com/gnea/grbl/wiki/Wiring-Limit-Switches">Grbl Wiki</a> on the matter. Based on that I’ve created <a href="https://github.com/dzervas/grbl-optocoupler-ltv846">this</a> board that has 4 optocouplers to isolate the limit switch circuit from the rest of the controller. Worked wanders for me</p>  </div> <footer class="post-footer" data-astro-cid-gjtny2mx> <div class="footer-sep" aria-hidden="true" data-astro-cid-gjtny2mx></div> <div class="author-card" data-astro-cid-gjtny2mx> <img src="https://www.gravatar.com/avatar/c9ccfe62d2de0aebdb79a1e7cf5c7019?s=100&d=identicon" alt="dzervas" class="author-avatar" width="64" height="64" data-astro-cid-gjtny2mx> <div class="author-info" data-astro-cid-gjtny2mx> <p class="author-label" data-astro-cid-gjtny2mx>// written_by</p> <p class="author-name" data-astro-cid-gjtny2mx>dzervas</p> <p class="author-bio" data-astro-cid-gjtny2mx>Creator of this site and lover of fails.</p> </div> </div> </footer> </article>  </main> <footer class="site-footer" data-astro-cid-sz7xmlte> <div class="footer-separator" aria-hidden="true" data-astro-cid-sz7xmlte></div> <div class="footer-inner" data-astro-cid-sz7xmlte> <div class="footer-main" data-astro-cid-sz7xmlte> <nav class="footer-social" aria-label="Social links" data-astro-cid-sz7xmlte> <ul class="social-list" data-astro-cid-sz7xmlte> <li data-astro-cid-sz7xmlte> <a href="https://kafeneio.social/@dzervas" class="social-link" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-mastodon "><path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.432 4.014.535c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.41 2.405 1.228l.518.869.519-.869c.533-.818 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558z"/></svg> <span class="social-label" data-astro-cid-sz7xmlte>Mastodon</span> </a> </li><li data-astro-cid-sz7xmlte> <a href="https://github.com/dzervas/whynot.fail" class="social-link" target="_blank" rel="noopener noreferrer" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github "><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg> <span class="social-label" data-astro-cid-sz7xmlte>GitHub</span> </a> </li><li data-astro-cid-sz7xmlte> <a href="/rss.xml" class="social-link" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-rss "><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg> <span class="social-label" data-astro-cid-sz7xmlte>RSS Feed</span> </a> </li> </ul> </nav> </div> </div> </footer>  <nav class="webring" aria-label="Webring"> <a class="webring-link edge-link webring-link--prev" href="https://webring.stavros.io/prev"> <span class="webring-arrow" aria-hidden="true">&lt;</span> <span class="webring-label">Previous blog</span> </a> <a class="webring-link edge-link webring-link--next" href="https://webring.stavros.io/next"> <span class="webring-arrow" aria-hidden="true">&gt;</span> <span class="webring-label">Next blog</span> </a> </nav> <a class="back-to-top edge-link" href="#top" data-back-to-top> <span class="webring-arrow back-to-top-arrow" aria-hidden="true">^</span> <span class="webring-label back-to-top-label">Top</span> </a> </div> <div class="search-overlay" data-search-overlay hidden> <div class="search-backdrop" data-search-close></div> <div class="search-panel" role="dialog" aria-modal="true" aria-label="Search"> <header class="search-header"> <input type="search" class="search-input" placeholder="Search posts..." aria-label="Search posts" data-search-input> <button class="search-close" type="button" aria-label="Close search" data-search-close>
&times;
</button> </header> <div class="search-results" data-search-results> <p class="search-empty">Type something and hit Enter. Or just panic.</p> </div> </div> </div>  <script type="module">const e=document.querySelector("[data-back-to-top]"),t=document.querySelector(".site-footer"),r=()=>{e instanceof HTMLElement&&e.toggleAttribute("data-visible",window.scrollY>240)},o=()=>{if(!(e instanceof HTMLElement)||!(t instanceof HTMLElement))return;const n=t.getBoundingClientRect().height;e.style.setProperty("--footer-height",`${n}px`)};r();o();window.addEventListener("scroll",r,{passive:!0});window.addEventListener("resize",o,{passive:!0});window.addEventListener("load",o,{passive:!0});t&&new ResizeObserver(o).observe(t);</script> <script type="module">const y={cdnUrl:"https://cdn.jsdelivr.net/npm/lunr/lunr.min.js"},c=document.querySelector("[data-search-overlay]"),r=document.querySelector("[data-search-results]"),i=document.querySelector("[data-search-input]"),w=document.querySelectorAll("[data-search-close]"),g=document.querySelector("[data-search-trigger]");c&&(c.hidden=!0);let l=null,u=[],o=null,s=-1;const L=()=>new Promise((e,t)=>{if(window.lunr){e(window.lunr);return}const n=document.createElement("script");n.src=y.cdnUrl,n.async=!0,n.onload=()=>{window.lunr?e(window.lunr):t(new Error("Lunr CDN loaded without window.lunr"))},n.onerror=()=>t(new Error("Failed to load Lunr CDN")),document.head.appendChild(n)}),E=async()=>o||(o=await L(),o),k=e=>e.length===0?'<p class="search-empty">No matches. Try a different incantation.</p>':(e.length>10?e.slice(0,10):e).map((n,a)=>{const d=n.tags.slice(0,3).map(m=>`<span class="search-tag">${m}</span>`).join("");return`
        <a class="search-item${a===s?" is-active":""}" data-search-item href="${n.slug}">
          <span class="search-title">${n.title}</span>
          <span class="search-description">${n.description}</span>
          <span class="search-tags">${d}</span>
        </a>
      `}).join(""),p=()=>{!c||!i||(c.hidden=!1,document.body.classList.add("search-open"),i.value="",s=-1,r&&(r.innerHTML='<p class="search-empty">Type something and hit Enter. Or just panic.</p>'),window.setTimeout(()=>i.focus(),0))},h=()=>{c&&(c.hidden=!0,document.body.classList.remove("search-open"))},v=async()=>{if(l)return;u=await(await fetch("/search.json")).json(),l=(await E())(function(){this.ref("slug"),this.field("title"),this.field("description"),this.field("tags"),this.field("category"),u.forEach(n=>this.add(n))})},A=async e=>{if(!r)return[];if(await v(),!l)return[];const n=l.search(e).slice(0,25).map(a=>u.find(d=>d.slug===a.ref)).filter(a=>!!a);return r.innerHTML=k(n),n},f=e=>{if(!r)return;const t=Array.from(r.querySelectorAll("[data-search-item]"));t.length!==0&&(s=(s+e+t.length)%t.length,t.forEach((n,a)=>{n.classList.toggle("is-active",a===s)}),t[s].scrollIntoView({block:"nearest"}))},C=()=>{if(!r)return;const e=Array.from(r.querySelectorAll("[data-search-item]"));e.length===0||s<0||e[s].click()},S=e=>{if((e.metaKey||e.ctrlKey)&&e.key.toLowerCase()==="k"){e.preventDefault(),p();return}if(e.key==="Escape"){h();return}!c||c.hidden||((e.key==="ArrowDown"||e.key.toLowerCase()==="j")&&(e.preventDefault(),f(1)),(e.key==="ArrowUp"||e.key.toLowerCase()==="k")&&(e.preventDefault(),f(-1)),e.key==="Enter"&&(e.preventDefault(),C()))};i&&i.addEventListener("input",e=>{const t=e.target.value.trim();if(t.length===0){s=-1,r&&(r.innerHTML='<p class="search-empty">Type something and hit Enter. Or just panic.</p>');return}A(t).then(()=>{s=-1,r&&r.querySelectorAll("[data-search-item]").forEach(a=>a.classList.remove("is-active"))})});w.forEach(e=>e.addEventListener("click",h));g?.addEventListener("click",p);document.addEventListener("keydown",S);document.addEventListener("click",e=>{const t=e.target;(t.matches("[data-search-close]")||t.closest("[data-search-close]"))&&h()});const j=document.documentElement;j.classList.add("js-enabled");</script> </body> </html>  